<!DOCTYPE html>
<html lang="de">

<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
  <meta charset="utf-8">
  <link rel="dns-prefetch" href="//www.google-analytics.com">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="keywords" content="">

  <title>Angular Environments einrichten & testen | Angular.DE</title>
  
  <meta name="description" content="So k√∂nnen Angular Environments konfiguriert, typ-sicher f√ºr mehrere Builds genutzt und mit einem Mock getestet werden - produktionsreif und mit Beispielen">
  

  
  <!-- Use canonical_url if available is post -->
  
  <link rel="canonical" href="http://localhost:4000/artikel/angular-environments/">
  
  

  

  <!-- Facebook Tags -->

  <meta name="og:title" content="Angular Environments einrichten & testen - Angular.DE">



  <meta property="og:description" content="So k√∂nnen Angular Environments konfiguriert, typ-sicher f√ºr mehrere Builds genutzt und mit einem Mock getestet werden - produktionsreif und mit Beispielen">


<meta property="og:url" content="http://localhost:4000/artikel/angular-environments/" />

  <meta property="og:type" content="article" />



  <meta property="og:image" content="http://localhost:4000/opengraph/default.png" />


<!-- Twitter Tags -->
<meta name="twitter:card" content="summary_large_image">


  <meta name="twitter:title" content="Angular Environments einrichten & testen - Angular.DE">


<meta name="twitter:site" content="@angular_de">
<meta name="twitter:creator" content="@angular_de">

  <meta name="twitter:description" content="So k√∂nnen Angular Environments konfiguriert, typ-sicher f√ºr mehrere Builds genutzt und mit einem Mock getestet werden - produktionsreif und mit Beispielen">


  <meta name="twitter:image" content="http://localhost:4000/artikel/angular-environments/banner.png">



  <link rel="icon" href="/assets/img/favicon.ico?v=2" type="image/x-icon" />
  <link rel="stylesheet" href="/assets/css/app.css?1750255920177315000">
  
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "url": "http://localhost:4000",
  "logo": "http://localhost:4000/assets/img/logo.svg",
  "sameAs":[
    "https://twitter.com/angular_de"
  ]
}
</script>
  
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "http://localhost:4000"
    },
    
      
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Artikel",
      "item": "http://localhost:4000/artikel/"
    },
      
    
      
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Angular Environments einrichten & testen"
    }
      
    
  ]
}
</script>
</head>

<!-- Position relative is for Bootstrap TOC Plugin -->

<body style="position: relative" data-bs-spy="scroll" data-bs-target="#toc">
  <div class="navbar-wrapper">
  
  <div class="navbar-banner">
    <div class="d-flex align-items-center justify-content-center">
      <a href="https://workshops.de/schulungsthemen/angular?utm_source=angular_de&utm_campaign=group_discount&utm_medium=portal&utm_content=banner" target="_blank">Wir bieten einen <b>3=2 Rabatt</b> auf Schulungen an! Buche 2 Teilnehmer:innen und der/die Dritte ist kostenfrei.</a>
    </div>
  </div>



  <nav class="navbar navbar-main navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand p-0 me-4" href="/">
        <img alt="Angular.DE powered by workshops.de" src="/assets/img/logo-with-poweredby.svg" height="45">
      </a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse mt-3 mt-sm-0" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item active">
            <a class="nav-link" href="/artikel/">Artikel</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="/artikel/angular-tutorial-deutsch/">Tutorial</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="/schulungen/angular-intensiv/">Schulung</a>
          </li>
          <!-- <li class="nav-item">
            <a class="nav-link" href="https://workshops.de/seminare-schulungen-kurse/angular-lifetime?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=navigation" target="_blank">Lifetime</a>
          </li>-->
          <li class="nav-item ">
            <a class="nav-link" href="/ng-de-konferenz/">NG-DE Konferenz</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="/team/">Team</a>
          </li>
          <!-- <li class="nav-item">
            <a class="nav-link" href="/discord" target="_blank"><span class="visually-hidden">Community </span>Discord</a>
          </li> -->
          <!-- <li class="nav-item ">
            <a class="nav-link" href="/jobs/">Jobs</a>
          </li> -->
        </ul>
        <form class="form-inline d-none d-lg-inline" action="/suche/" method="GET">
          <input name="q" class="form-control navbar-search" type="search" placeholder="&#xF002;" autocomplete="off">
        </form>
      </div>
    </div><!-- .container -->
  </nav>
</div>


  


<main role="main" class="mt-4">
  <article lang="de" class="container">

    <div class="ratio mb-4" style="--bs-aspect-ratio: 30%;">
      <img src="banner.png" class="rounded w-100 object-fit-cover" alt="Artikel Header Bild zu Angular Environments einrichten & testen" />
    </div>
    <div class="row mb-5 gx-6">
      <div class="col-md-12 col-lg-8 mb-2">
        <h1 class="header-post-title">Angular Environments einrichten & testen</h1>

        <p class="text-muted">
          <small>
            
            <a href="/kategorie/angular/" class="badge bg-secondary text-bg-secondary text-uppercase">angular</a>
            
            <a href="/kategorie/environments/" class="badge bg-secondary text-bg-secondary text-uppercase">environments</a>
            
            <span class="ms-1 me-1">|</span>
            Nils Mehlhorn
            
            <a href="https://twitter.com/n_mehlhorn" target="_blank" style="margin-bottom: 5px;">
              <img src="/shared/assets/img/twitter-logo.svg" height="12" alt="Twitter Logo" />
            </a>
            
            
            <span class="ms-1 me-1">‚Ä¢</span> <time>10.08.2020</time>
            <span class="ms-1 me-1">|</span>
            


  9 Minuten


          </small>
        </p>


        <div class="c-content">
          <p>Die meisten professionellen Angular Anwendungen durchlaufen im Entwicklungszyklus mehrere Ausf√ºhrungs-Umgebungen. W√§hrend die Unterschiede zwischen diesen Umgebungen f√ºr eine reibungslose Auslieferung m√∂glichst gering gehalten werden sollten, muss sich deine Webapp wahrscheinlich auf einer Entwicklungsmaschine ein bisschen anders verhalten als im produktiven Betrieb.</p>

<p>Angular bietet hierf√ºr bereits eine L√∂sung namens <a href="https://v17.angular.io/guide/build#configuring-application-environments" rel="noreferrer noopener" target="_blank">Environments</a> an. Die funktionieren wie folgt: man legt eine beliebige Anzahl an Environment-Dateien in einem Ordner, bspw. <code class="language-plaintext highlighter-rouge">src/environments</code>, an:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>src
‚îî‚îÄ‚îÄ environments
 ¬†¬† ‚îú‚îÄ‚îÄ environment.prod.ts
 ¬†¬† ‚îú‚îÄ‚îÄ environment.stage.ts
 ¬†¬† ‚îî‚îÄ‚îÄ environment.ts
</code></pre></div></div>

<p>Alle Environments au√üer der Standardumgebung (meist die Entwicklungsumgebung) erhalten ein entsprechendes Suffix - bspw. ‚Äòprod‚Äô f√ºr die Produktivumgebung.</p>

<p>In jedem dieser Files wird ein Objekt namens <code class="language-plaintext highlighter-rouge">environment</code> exportiert, welche alle die gleichen Properties jeweils mit umgebungsspezifischen Werten bereitstellen. Das k√∂nnten zum Beispiel der Name der Umgebung oder ein boolsches Flag sein, das angibt ob, wir uns in einer Produktivumgebung befinden.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// environment.ts</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">environment</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">production</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">dev</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">apiPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/api</span><span class="dl">'</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// environment.stage.ts</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">environment</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">production</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">stage</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">apiPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/stage/api</span><span class="dl">'</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// environment.prod.ts</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">environment</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">production</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">prod</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">apiPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/prod/api</span><span class="dl">'</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Manchmal unterscheidet sich auch der Pfad unter dem der Backend-Server erreichbar ist (hier <code class="language-plaintext highlighter-rouge">apiPath</code> genannt). F√ºr Eigenschaften die an vielen Stellen gebraucht werden, deren Wert aber in jeder Umgebung gleich ist, kann √ºbrigens besser ein einziger File names <code class="language-plaintext highlighter-rouge">constants.ts</code> angelegt werden. Das spart unn√∂tigen Mehrfachaufwand.</p>

<p>Um nun in der Anwendung immer das richtige Environment f√ºr verschiedene Builds zu verwenden, legen wir jeweils eine Build-Konfiguration in der <code class="language-plaintext highlighter-rouge">angular.json</code> an. In jeder Konfiguration richten wir ein <a href="https://v17.angular.io/guide/build#configure-target-specific-file-replacements" rel="noreferrer noopener" target="_blank">File Replacement</a> ein, welches <code class="language-plaintext highlighter-rouge">environment.ts</code> immer durch eine spezifische Alternative wie <code class="language-plaintext highlighter-rouge">environment.prod.ts</code> austauscht:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"architect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="err">...</span><span class="w">
  </span><span class="nl">"build"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"builder"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@angular-devkit/build-angular:browser"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="nl">"configurations"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"production"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"fileReplacements"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
          </span><span class="nl">"replace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/environments/environment.ts"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"with"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/environments/environment.prod.ts"</span><span class="w">
        </span><span class="p">}],</span><span class="w">
        </span><span class="err">...</span><span class="w">
      </span><span class="p">}</span><span class="w">
      </span><span class="nl">"stage"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"fileReplacements"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
          </span><span class="nl">"replace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/environments/environment.ts"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"with"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src/environments/environment.stage.ts"</span><span class="w">
        </span><span class="p">}],</span><span class="w">
        </span><span class="err">...</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Beim Build aktivieren wir eine der Konfigurationen indem wir dessen Namen an die Angular CLI mitgeben:</p>
<pre><code class="language-commandline">ng build --configuration &lt;config&gt;
</code></pre>

<p><strong>Tipp</strong>: Wenn man <code class="language-plaintext highlighter-rouge">ng build --prod</code> verwendet, nimmt Angular die Konfiguration names ‚Äòproduction‚Äô.</p>

<p>Das ist eigentlich schon alles: Dateien werden ersetzt um ganz normale JavaScript-Objekte bereitzustellen - nicht viel Angular-Magie im Spiel. Jetzt muss man innerhalb der Anwendung nur aus <code class="language-plaintext highlighter-rouge">environment.ts</code> importieren und bekommt zur Laufzeit immer die umgebungsspezifischen Werte:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">environment</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../environments/environment</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// ng build             --&gt; 'dev'</span>
<span class="c1">// ng build -c stage    --&gt; 'stage'</span>
<span class="c1">// ng build --prod      --&gt; 'prod'</span>
<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">environment</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
</code></pre></div></div>

<p>Aber wir kriegen das noch besser hin. Beim aktuellen Aufbau sind mir in der Praxis n√§mlich noch zwei Probleme aufgefallen:</p>
<ol>
  <li>Wenn man neue Felder zu <code class="language-plaintext highlighter-rouge">environment.ts</code> hinzuf√ºgt, kommt es schnell vor, dass man vergisst, die entsprechenden Gegenst√ºcke in den anderen Environment-Dateien anzulegen</li>
  <li>Man kann nur schwierig umgebungspezifische Tests durchf√ºhren</li>
</ol>

<p>Das k√∂nnen wir mit ein paar leichten Anpassungen in unserem Setup √§ndern.</p>

<h2 id="environments-typisieren">Environments typisieren</h2>

<p>Wenn man mit Angular unterwegs ist, benutzt man TypeScript - warum also nicht von der statischen Typisierung der Sprache profitieren? Indem wir einen Typ f√ºr unser Environment definieren, sagt uns der Compiler bescheid, wenn in irgendeiner Umgebung Werte fehlen. Hierzu legen wir ein Interface in einer Datei names <code class="language-plaintext highlighter-rouge">ienvironment.ts</code> an. Das Ganze muss in eine andere Datei, da wir sonst Probleme mit den File Replacements bekommen - ansonsten rate ich davon ab, Prefix wie <code class="language-plaintext highlighter-rouge">i</code> f√ºr Interfaces zu verwenden.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">Environment</span> <span class="p">{</span>
  <span class="nl">production</span><span class="p">:</span> <span class="nx">boolean</span>
  <span class="nx">name</span><span class="p">:</span> <span class="kr">string</span>
  <span class="nx">apiPath</span><span class="p">:</span> <span class="kr">string</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Wenn wir nun ein Environment-Objekt definieren, deklarieren wir auch direkt dessen Typ mit dem gerade angelegten Interface:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Environment</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./ienvironment</span><span class="dl">'</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">environment</span><span class="p">:</span> <span class="nx">Environment</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">production</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">dev</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">apiPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/api</span><span class="dl">'</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Wenn wir das f√ºr alle Environments machen, profitieren wir ganz leicht vom Typ-System und bekommen keine √úberraschungen mehr beim Deploy eines neuen, umgebungspezifischen Features.</p>

<h2 id="testen-mit-environments">Testen mit Environments</h2>

<p>Manchmal m√∂chte man gerne umgebungspezifische Tests durchf√ºhren. Vielleicht um einen Error-Handler zu testen, welcher w√§hrend der Entwicklung nur zur Konsole loggen, in Produktion aber die <a href="https://nils-mehlhorn.de/posts/angular-error-tracking-with-sentry" rel="noreferrer noopener" target="_blank">Fehler zu einem Server weiterleiten soll</a>. Da Environments meist einfach importiert sind, ist es etwas schwieriger diese f√ºr Tests zu mocken (sprich, durch ein Testdouble zu ersetzen). Das k√∂nnen wir √§ndern!</p>

<p>Die Architektur von Angular-Anwendungen basiert auf dem Prinzip der <a href="https://v17.angular.io/guide/dependency-injection" rel="noreferrer noopener" target="_blank">Dependency Injection</a> (DI). Das hei√üt, dass eine Klasse (bspw. eine Komponente oder ein Service) zum Zeitpunkt der Instanziierung mit allem versorgt wird, was diese ben√∂tigt. Angular l√∂st also alle Abh√§ngigkeiten zu anderen Instanzen auf und <em>injiziert</em> sie in den Konstruktor der Klasse. Das erlaubt es uns die Abh√§ngigkeiten leicht durch Testdouble auszutauschen.</p>

<p>Wenn wir unser Environment nun auch √ºber Dependency Injection bereitstellen, sind wir also auch in der Lage, umgebungsspezifische Testf√§lle durchzuf√ºhren. Hierzu erstellen wir noch eine weitere Datei <code class="language-plaintext highlighter-rouge">environment.provider.ts</code>, in welcher wir ein <a href="https://v17.angular.io/api/core/InjectionToken" rel="noreferrer noopener" target="_blank">InjectionToken</a> definieren. Normalerweise benutzt Angular den Klassennamen um Abh√§ngkeiten aufzul√∂sen, aber weil unser Environment nur ein TypeScript Interface ist (welches zur Laufzeit nicht mehr existiert), m√ºssen wir stattdessen ein solches Token als Ersatz bereitstellen. Zus√§tzlich, weil ein Interface auch keinen Konstrukt hat, den Angular aufrufen k√∂nnte, legen wir noch eine Factory-Methode an, die eine Environment-Instanz zur√ºckgibt. Letztendlich sieht der Code in <code class="language-plaintext highlighter-rouge">environment.provider.ts</code> dann so aus:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">InjectionToken</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Environment</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./ienvironment</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">environment</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./environment</span><span class="dl">'</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">ENV</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">InjectionToken</span><span class="o">&lt;</span><span class="nx">Environment</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">env</span><span class="dl">'</span><span class="p">)</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nf">getEnv</span><span class="p">():</span> <span class="nx">Environment</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">environment</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Anschlie√üend f√ºgen wir Token und Factory-Methode als Provider √ºber einen Eintrag in <code class="language-plaintext highlighter-rouge">providers</code> zu unserem Angular-Modul hinzu:</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">ENV</span><span class="p">,</span> <span class="nx">getEnv</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../environments/environment.provider</span><span class="dl">'</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="p">...</span>
  <span class="na">providers</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span><span class="na">provide</span><span class="p">:</span> <span class="nx">ENV</span><span class="p">,</span> <span class="na">useFactory</span><span class="p">:</span> <span class="nx">getEnv</span><span class="p">}</span>
  <span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nc">AppModule</span> <span class="p">{</span> <span class="p">}</span>
</code></pre></div></div>

<p>Anstatt nun direkt aus <code class="language-plaintext highlighter-rouge">environment.ts</code> zu importieren, injiizieren wir das Environment in jede Klasse, welche umgebungsspezifische Informationen ben√∂tigt. Hierzu verwendet man den <a href="https://v17.angular.io/api/core/Inject" rel="noreferrer noopener" target="_blank">Inject</a> Decorator mit unserem Token wie folgt:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span><span class="p">,</span> <span class="nx">Inject</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Environment</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../environments/ienvironment</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ENV</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../environments/environment.provider</span><span class="dl">'</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="p">{</span>

  <span class="nf">constructor</span><span class="p">(@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">ENV</span><span class="p">)</span> <span class="k">private</span> <span class="nx">env</span><span class="p">:</span> <span class="nx">Environment</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nf">save</span><span class="p">(</span><span class="nx">user</span><span class="p">:</span> <span class="nx">User</span><span class="p">):</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">User</span><span class="o">&gt;</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">production</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">...</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="p">...</span>
      <span class="p">}</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>

<p>Um dann einen Mock f√ºr das Environment w√§hrend eines Tests zu nutzen, k√∂nnen wir entweder direkt den <a href="https://v17.angular.io/guide/testing-services" rel="noreferrer noopener" target="_blank">Klassen-Konstruktor verwenden</a> oder einen alternativen <a href="https://v17.angular.io/guide/testing-components-basics" rel="noreferrer noopener" target="_blank">Provider √ºber Angular‚Äôs TestBed bereitstellen</a>:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ENV</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../environments/environment.provider</span><span class="dl">'</span>

<span class="nf">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">UserService</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nf">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">when in production</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nf">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">env</span> <span class="o">=</span> <span class="p">{</span><span class="na">production</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="p">...}</span>
        <span class="c1">// ohne TestBed</span>
        <span class="kd">const</span> <span class="nx">service</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UserService</span><span class="p">(</span><span class="nx">env</span><span class="p">)</span>
        <span class="c1">// mit TestBed</span>
        <span class="nx">TestBed</span><span class="p">.</span><span class="nf">configureTestingModule</span><span class="p">({</span>
          <span class="na">providers</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="na">provide</span><span class="p">:</span> <span class="nx">ENV</span><span class="p">,</span> <span class="na">useValue</span><span class="p">:</span> <span class="nx">env</span><span class="p">}</span>
          <span class="p">]</span>
        <span class="p">});</span>
      <span class="p">});</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Wenn man sichergehen will, dass niemand aus Versehen doch direkt aus <code class="language-plaintext highlighter-rouge">environment.ts</code> importiert, kann man sogar eine <a href="https://stackoverflow.com/questions/51742983/how-blacklist-imports-in-a-specific-file-with-tslint" rel="noreferrer noopener" target="_blank">entsprechende TSLint-Regel anlegen</a>.</p>

<h3 id="fazit">Fazit</h3>

<p>Mit wenig Aufwand sind wir in der Lage, Angular Environments sicherer und komfortabler zu gestalten. Wenn wir Werkzeuge wie Typisierung und Dependency Injection bereits haben, ergibt es Sinn, diese auch konsequent f√ºr eine bessere Entwicklungserfahrung zu nutzen. Gerade in gr√∂√üeren Anwendungen mit mehreren Umgebungen k√∂nnen wir von ordentlich definierten Interfaces, guter Testabdeckung und testgetriebener Entwicklung profitieren.</p>

        </div>

        <div class="text-end">
          <a class="btn btn-sm btn-link link-secondary" href="https://github.com/workshops-de/angular.de/edit/master/_posts/2020-08-10-angular-environments/2020-08-10-angular-environments.md" target="_blank" rel="noopener noreferrer nofollow">
            üêõ Diesen Artikel auf GitHub verbessern
          </a>
        </div>
      </div>
      <div class="col-lg-4 d-none d-lg-block">
        <div class="position-sticky c-top-4 ms-2">
          <p class="text-muted text-uppercase"><small>Inhaltsverzeichnis</small></p>
          <nav id="toc" data-toggle="toc"></nav>
          <!-- <hr> -->
          <!-- <div>
            <div class="h5 mb-2">Email Newsletter</div>
            <p class="small mb-2">Um alle Neuigkeiten zu erfahren, abonniere hier unseren Newsletter!</p>
            <a class="btn btn-sm btn-primary" href="/newsletter/redirect/article" target="_blank">
              Newsletter abonnieren
            </a>
          </div> -->

          <div class="mt-4">
            <a href="https://ng-de.org?utm_source=angular_de&utm_campaign=conference2025&utm_medium=portal&utm_content=article_sidebar"
               target="_blank"
               class="d-block text-decoration-none">
              <div class="card border-0 shadow-sm h-100" style="transition: all 150ms;">
                <img src="/assets/img/ngde-conf-ad.png"
                     class="card-img-top rounded-top"
                     alt="NG-DE Conference - November 5-7, 2025"
                     style="object-fit: cover; height: 100%;">
                <div class="card-body p-3">
                  <h5 class="card-title text-dark fw-bold mb-2">NG-DE Conference</h5>
                  <p class="card-text text-muted small mb-2">
                    The community-driven Angular conference in Germany
                  </p>
                  <div class="d-flex align-items-center mb-2">
                    <i class="fa fa-calendar text-primary me-2" style="width: 12px;"></i>
                    <small class="text-muted">November 5-7, 2025</small>
                  </div>
                  <div class="d-flex align-items-center mb-3">
                    <i class="fa fa-map-marker text-primary me-2" style="width: 12px;"></i>
                    <small class="text-muted">Berlin</small>
                  </div>
                  <div class="d-flex justify-content-between align-items-center">
                    <span class="btn btn-primary btn-sm fw-bold text-uppercase" style="font-size: 0.7rem; letter-spacing: 0.05em; padding: 0.375rem 0.75rem;">
                      Get your ticket now!
                    </span>
                  </div>
                </div>
              </div>
            </a>
          </div>

          <style>
            .mt-4 a:hover .card {
              box-shadow: 0 0 4px 0 rgba(0,0,0,0.35) !important;
            }

            .mt-4 a:hover .card-title {
              color: #0d6efd !important;
            }
          </style>
        </div>
      </div>
    </div>
    <div class="row mt-4">
      <div class="col-md-12 col-lg-8">
        <!-- author info -->

<div class="row">
  <div class="col-sm-3 col-md-2">
    <span>
      <img alt="Nils Mehlhorn" class="shadow-sm rounded img-fluid lazy"
      src="/shared/assets/img/placeholder-image.svg"
      
      data-src="/assets/img/avatars/nils-mehlhorn.jpg"
      data-srcset="/assets/img/avatars/nils-mehlhorn.jpg"
      
      >
    </span>
  </div>
  <div class="col-sm-9 col-md-10">
    <p class="h5 text-truncate mb-2">
      Nils Mehlhorn
    </p>
    
      <p class="text-muted small">
        Nils ist Co-Founder von SceneLab und freiberuflicher Software Engineer mit Fokus auf Web-Technologien. In Artikeln und Vortr√§gen teilt er seine langj√§hrige Erfahrung mit Angular, TypeScript und Node.js sowie dem Java-basierten Spring Framework.

      </p>
    
    <div>
      
        <a href="https://nils-mehlhorn.de" class="btn btn-sm btn-outline-secondary" target="_blank" rel="noopener noreferrer">Website</a>
      
      
        <a href="https://github.com/nilsmehlhorn" class="btn btn-sm btn-outline-secondary" target="_blank">Github</a>
      
      
        <a href="https://twitter.com/n_mehlhorn" class="btn btn-sm btn-outline-secondary" target="_blank">Twitter</a>
      
      
    </div>
  </div>
</div>

        
      </div>
    </div>
  </article>

  <div class="container-fluid">
    <div class="row justify-content-md-center no-gutters mt-6">
      





  
  

  

  
    <div class="col-sm-6 p-0">
  <a class="ratio ratio-16x9 d-flex align-items-center c-img-bg-backdrop c-bg-img-cover-center lazy"
    style="background-image: url('/shared/assets/img/placeholder-image.svg');"
    href="/artikel/ng-de-conference-2025-ankuendigung/"
    data-style="background-image: url('/artikel/ng-de-conference-2025-ankuendigung/header.jpg')"
    >
    <div class="d-flex flex-column align-items-center justify-content-center px-4">
      <div class="text-center w-100 h2 text-white">
        NG-DE Conference 2025 wieder in Berlin
      </div>
      <button class="btn btn-outline-light">Hier weiterlesen</button>
    </div>
  </a>
</div>


    
    
  



  
  

  

  
    <div class="col-sm-6 p-0">
  <a class="ratio ratio-16x9 d-flex align-items-center c-img-bg-backdrop c-bg-img-cover-center lazy"
    style="background-image: url('/shared/assets/img/placeholder-image.svg');"
    href="/artikel/angular-tutorial-deutsch/"
    data-style="background-image: url('/artikel/angular-tutorial-deutsch/header.jpg')"
    >
    <div class="d-flex flex-column align-items-center justify-content-center px-4">
      <div class="text-center w-100 h2 text-white">
        Angular 20 Tutorial f√ºr Einsteiger
      </div>
      <button class="btn btn-outline-light">Hier weiterlesen</button>
    </div>
  </a>
</div>


    
    
      

    </div>
  </div>
</main>

  
<div class="newsletter-section d-print-none py-5">
  <div class="container">
    <p class="lead text-center">Du m√∂chtest immer auf dem aktuellsten Stand sein? - Melde Dich f√ºr unseren Newsletter an!</p>
    <div class="text-center">
      <a class="btn btn-primary" href="/newsletter/redirect/footer" target="_blank">
        Jetzt f√ºr Neuigkeiten zu Angular anmelden!
      </a>
    </div>
  </div>
</div>


  <footer>
  <div class="container">
    <div class="row">
      <div class="col-6 col-sm-3 mb-2">
        <div class="h4 mb-2">Angular.DE</div>
        <small>
          <span class="fw-bolder">Powered by <a href="https://workshops.de?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=footer_nav">Workshops.DE</a></span>.
        </small>
      </div>
      <div class="col-6 col-sm-3 mb-2">
        <div class="h6 text-uppercase">Navigation</div>
        <ul class="footer-nav">
          <li><a href="/artikel/">Artikel</a></li>
          <li><a href="/tutorials/">Tutorials</a></li>
          <li><a href="/schulungen/">Schulungen</a></li>
          <li><a href="https://workshops.de/seminare-schulungen-kurse/angular-lifetime?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=footer_nav" target="_blank">Lifetime</a></li>
          <li><a href="/meetups/">Meetups</a></li>
          <li><a href="/team/">Team</a></li>
          <li><a href="/presskit/">Presskit</a></li>
        </ul>
      </div>
      <div class="col-6 col-sm-3 mb-2">
        <div class="h6 text-uppercase">Communities</div>
        <ul class="footer-nav">
          <li><a href="https://reactjs.de?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=footer_nav" target="_blank">ReactJS.DE</a></li>
          <li><a href="https://vuejs.de?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=footer_nav" target="_blank">VueJS.DE</a></li>
          <li><a href="https://cloudnative.eu?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=footer_nav" target="_blank">CloudNative.EU</a></li>
          <li><a href="https://a11y-masterclass.de?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=footer_nav" target="_blank">a11y Masterclass</a></li>
          <li><a href="https://workshops.de?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=footer_nav" target="_blank">Workshops.DE</a></li>
          <li><a href="https://www.coding-bootcamps.eu?utm_source=angular_de&utm_campaign=crossmarketing_permanent&utm_medium=portal&utm_content=footer_nav" target="_blank">Coding Bootcamp Europe</a></li>
          <li><a href="https://ng-de.org?utm_source=angular_de&utm_campaign=conference2025&utm_medium=portal&utm_content=footer_nav" target="_blank">NG-DE Konferenz</a></li>
        </ul>
      </div>
      <div class="col-6 col-sm-3 mb-2">
        <div class="h6 text-uppercase">Folge uns hier</div>
        <ul class="footer-nav">
          <li>
            <a href="https://twitter.com/angular_de" target="_blank" rel="noopener">Twitter</a>
          </li>
          <li>
            <a href="https://github.com/workshops-de" target="_blank" rel="noopener">GitHub</a>
          </li>
          <li><a href="/feed.xml" target="_blank" rel="nofollow">RSS-Feed</a></li>
        </ul>
      </div>
    </div>
    <hr />
    <div class="row align-items-center">
      <div class="col-6 small">
        Copyright ¬© 2025 Symetics GmbH
      </div>
      <div class="col-6">
        <ul class="nav justify-content-end">
          <li class="nav-item">
            <a class="nav-link" href="/impressum/">Impressum</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/datenschutz/">Datenschutz</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</footer>

  
  

  

  
  


  <script type="text/javascript">
  (() => {

    function lazyLoadImages() {
      var lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));

      if ("IntersectionObserver" in window) {
        let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
          entries.forEach(function(entry) {
            if (entry.isIntersecting) {
              let lazyImage = entry.target;
              lazyImage.src = lazyImage.dataset.src;
              lazyImage.srcset = lazyImage.dataset.srcset;
              lazyImage.classList.remove("lazy");
              lazyImageObserver.unobserve(lazyImage);
            }
          });
        });

        lazyImages.forEach(function(lazyImage) {
          lazyImageObserver.observe(lazyImage);
        });
      } else {
        // Possibly fall back to a more compatible method here
        lazyImages.forEach(function(lazyImage) {
          lazyImage.src = lazyImage.dataset.src;
          lazyImage.srcset = lazyImage.dataset.srcset;
          lazyImage.classList.remove("lazy");
        });
      }
    }

    function lazyLoadBackgroundImages() {
      var lazyImages = [].slice.call(document.querySelectorAll("a.lazy"));

      if ("IntersectionObserver" in window) {
        let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
          entries.forEach(function(entry) {
            if (entry.isIntersecting) {
              let lazyImage = entry.target;
              lazyImage.style = lazyImage.dataset.style;
              lazyImage.classList.remove("lazy");
              lazyImageObserver.unobserve(lazyImage);
            }
          });
        });

        lazyImages.forEach(function(lazyImage) {
          lazyImageObserver.observe(lazyImage);
        });
      } else {
        // Possibly fall back to a more compatible method here
        lazyImages.forEach(function(lazyImage) {
          lazyImage.src = lazyImage.dataset.src;
          lazyImage.srcset = lazyImage.dataset.srcset;
          lazyImage.classList.remove("lazy");
        });
      }
    }

    document.addEventListener("DOMContentLoaded", function() {
      lazyLoadImages();
      lazyLoadBackgroundImages();
      });
  })();
</script>

  <!-- JavaScript -->
  <script src="/shared/assets/js/vendor/jquery-3.2.1.slim.min.js"></script>
  <script src="/shared/assets/js/vendor/bootstrap.min.js"></script>
  <script src="/shared/assets/js/vendor/fp-3.0.0.min.js"></script>
  <script src="/shared/assets/js/vendor/headroom.min.js"></script>
  <script src="/shared/assets/js/app.js"></script>
  
  <script src="/shared/assets/js/vendor/bootstrap-toc-1.0.0.min.js"></script>
  
  
  
</body>

</html>
